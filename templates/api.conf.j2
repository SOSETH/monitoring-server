/**
 * The API listener is used for distributed monitoring setups.
 */

object ApiListener "api" {
  cert_path = SysconfDir + "/icinga2/pki/server.crt"
  key_path = SysconfDir + "/icinga2/pki/server.key"
  ca_path = SysconfDir + "/icinga2/pki/ca-mag.crt"

  ticket_salt = TicketSalt
  accept_config = true
}

{% for host in groups['mon-server'] %}
{% if host != ansible_fqdn %}
object ApiUser "{{ host }}" {
  client_cn = "{{ host }}"
}
{% endif %}
{% endfor %}
